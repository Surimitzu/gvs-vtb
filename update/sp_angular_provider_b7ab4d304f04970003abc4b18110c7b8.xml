<?xml version="1.0" encoding="UTF-8"?>
<record_update table="sp_angular_provider">
    <sp_angular_provider action="INSERT_OR_UPDATE">
        <name>gvsVtbTaskService</name>
        <script><![CDATA[function($http){
	var config = {
		params: {
			sysparm_fields: 'number, short_description, priority, assigned_to, state, sys_id',
			sysparm_display_value: 'all'
		}
	}

	var apiBaseUrl = function(tableName){
		return '/api/now/table/' + tableName;
	}
	
	var data = {};
	data.isLoading = false;
	data.loadingDisabled = false;

	data.tasks = [];
	

	data.getTasks = function(tableName, encodedQuery, startPos, rowCount){
		data.isLoading = true;
		config.params.sysparm_query = encodedQuery + '^ORDERBYDESCnumber';
		config.params.sysparm_limit = rowCount || '';
		config.params.sysparm_offset = startPos || 0;
		return $http.get(apiBaseUrl(tableName), config).then(
		function(response){
			//data.isLoading = false;
			if (response.data.length == 0){
				data.loadingDisabled = true;
			}
			return response;
		});
	};
	
	
	function attachResult(result){
		for (var i =0; i<result.length; i++){
			data.tasks.push(result[i]);
		}
	}

	data.appendTasks = function(tableName, encodedQuery, startPos, rowCount){ 
		return data.getTasks(tableName, encodedQuery, startPos, rowCount).then(function(response){
			attachResult(response.data.result);
	});
	};

	return data;

}]]></script>
        <sys_class_name>sp_angular_provider</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-01-31 12:03:28</sys_created_on>
        <sys_id>b7ab4d304f04970003abc4b18110c7b8</sys_id>
        <sys_mod_count>22</sys_mod_count>
        <sys_name>gvsVtbTaskService</sys_name>
        <sys_package display_value="[GVS] Visual Task Board" source="x_52098_gvs_vtb">933abc014f3b070003abc4b18110c713</sys_package>
        <sys_policy/>
        <sys_scope display_value="[GVS] Visual Task Board">933abc014f3b070003abc4b18110c713</sys_scope>
        <sys_update_name>sp_angular_provider_b7ab4d304f04970003abc4b18110c7b8</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-01-31 14:05:02</sys_updated_on>
        <type>service</type>
    </sp_angular_provider>
</record_update>
